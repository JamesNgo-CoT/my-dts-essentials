"use strict";var LoginView=Backbone.View.extend({tagName:"form",template:_.template('\n    <span class="visible-print-inline">Logged in as</span>\n    <%= model.lastName || \'\' %><%= model.lastName && model.firstName  ? \',\' : \'\' %>\n    <%= model.firstName || \'\' %>\n    <% if (model.sid == null) { %>\n    <button type="button" class="btn btn-primary btn-login">Login</button>\n    <% } else { %>\n    <button type="button" class="btn btn-default btn-logout">Logout</button>\n    <% } %>\n  '),doLogin:function(){this.showLogin({$originatingElement:this.$el.find("button")}).then(function(){Backbone.history.stop(),Backbone.history.start()})},doLogout:function(){this.model.cotLogin.logout()},events:{"click .btn-login":"doLogin","click .btn-logout":"doLogout"},requireLogin:function(o){var n=this;return Promise.resolve().then(function(){return n.model.checkLogin(o)}).catch(function(){return n.showLogin(o)}).catch(function(){return n.model.logout(),Promise.reject()})},render:function(){return this.$el.html(this.template({model:this.model.toJSON()})),Promise.resolve()},showLogin:function(){var t=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.model.cotLogin.modal&&this.model.cotLogin.modal.modal("hide"),new Promise(function(o,n){t.model.cotLogin.modal=cot_app.showModal({title:"User Login",body:"\n          "+t.model.cotLogin.options.loginMessage+'\n          <form>\n            <div class="form-group">\n              <label for="cot_login_username">Username</label>:\n              <input class="form-control" id="cot_login_username">\n            </div>\n            <div class="form-group">\n              <label for="cot_login_password">Password</label>:\n              <input class="form-control" type="password" id="cot_login_password">\n            </div>\n          </form>\n        ',footerButtonsHtml:'\n          <button class="btn btn-success" type="button" data-dismiss="modal">Cancel</button>\n          <button class="btn btn-success btn-cot-login" type="button">Login</button>\n        ',originatingElement:i.$originatingElement||$(t.model.cotLogin.options.welcomeSelector).find("a.login"),className:"cot-login-modal",onShown:function(){function n(){this.model.cotLogin._login()}t.model.cotLogin.modal.find(".btn-cot-login").click(function(){n()}),t.model.cotLogin.modal.find(".modal-body input").keydown(function(o){13===(o.charCode||o.keyCode||0)&&n()})},onHidden:function(){t.model.checkLogin(i).then(function(){o()},function(){n()})}})})},initialize:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.listenTo(this.model,"change",this.render)}});
//# sourceMappingURL=login_view.min.js.map
