{"version":3,"sources":["login/scripts/cot_login_ext.min.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","cot_login_ext","_cot_login","this","getPrototypeOf","apply","arguments","cot_login","_this2","undefined","serverSide","Promise","resolve","reject","session","isLoggedIn","result","CotSession","LOGIN_CHECK_RESULT_TRUE","options","_this3","then","checkLogin","catch","showLogin","logout","_this4","modal","cot_app","showModal","title","body","loginMessage","footerButtonsHtml","originatingElement","$originatingElement","$","find","className","onShown","click","_login","keydown","e","charCode","keyCode","onHidden"],"mappings":"AAAA,aAEA,IAAIA,aAAe,WAAc,SAASC,EAAiBC,EAAQC,GAAS,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,IAAIE,EAAaH,EAAMC,GAAIE,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,UAAWF,IAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,OAAO,SAAUO,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYb,EAAiBY,EAAYG,UAAWF,GAAiBC,GAAad,EAAiBY,EAAaE,GAAqBF,GAA7gB,GAEnB,SAASI,gBAAgBC,EAAUL,GAAe,KAAMK,aAAoBL,GAAgB,MAAM,IAAIM,UAAU,qCAEhH,SAASC,2BAA2BC,EAAMC,GAAQ,IAAKD,EAAQ,MAAM,IAAIE,eAAe,6DAAgE,OAAOD,GAAyB,iBAATA,GAAqC,mBAATA,EAA8BD,EAAPC,EAElO,SAASE,UAAUC,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAIP,UAAU,kEAAoEO,GAAeD,EAAST,UAAYN,OAAOiB,OAAOD,GAAcA,EAAWV,UAAW,CAAEY,YAAa,CAAEC,MAAOJ,EAAUlB,YAAY,EAAOE,UAAU,EAAMD,cAAc,KAAekB,IAAYhB,OAAOoB,eAAiBpB,OAAOoB,eAAeL,EAAUC,GAAcD,EAASM,UAAYL,GAKje,IAAIM,cAAgB,SAAUC,GAG5B,SAASD,IAGP,OAFAf,gBAAgBiB,KAAMF,GAEfZ,2BAA2Bc,MAAOF,EAAcD,WAAarB,OAAOyB,eAAeH,IAAgBI,MAAMF,KAAMG,YA8ExH,OAnFAb,UAAUQ,EAoFVM,WA5EAtC,aAAagC,EAAe,CAAC,CAC3BpB,IAAK,aACLiB,MAAO,WACL,IAAIU,EAASL,KAIb,OAFiC,EAAnBG,UAAUhC,aAA+BmC,IAAjBH,UAAU,GAAmBA,UAAU,GAAK,IAErEI,WAIN,IAAIC,QAAQ,SAAUC,EAASC,GACpCL,EAAOM,QAAQC,WAAW,SAAUC,GAC9BA,IAAWC,WAAWC,wBACxBN,IAEAC,QARGV,KAAKW,QAAQC,aAAeJ,QAAQC,UAAYD,QAAQE,WAalE,CACDhC,IAAK,eACLiB,MAAO,SAAsBqB,GAC3B,IAAIC,EAASjB,KAEb,OAAOQ,QAAQC,UAAUS,KAAK,WAC5B,OAAOD,EAAOE,WAAWH,KACxBI,MAAM,WACP,OAAOH,EAAOI,UAAUL,KACvBI,MAAM,WAEP,OADAH,EAAOK,SACAd,QAAQE,aAGlB,CACDhC,IAAK,YACLiB,MAAO,WACL,IAAI4B,EAASvB,KAETgB,EAA6B,EAAnBb,UAAUhC,aAA+BmC,IAAjBH,UAAU,GAAmBA,UAAU,GAAK,GAMlF,OAJIH,KAAKwB,OACPxB,KAAKwB,MAAMA,MAAM,QAGZ,IAAIhB,QAAQ,SAAUC,EAASC,GACpCa,EAAOC,MAAQC,QAAQC,UAAU,CAC/BC,MAAO,aACPC,KAAM,eAAiBL,EAAOP,QAAQa,aAAe,gcACrDC,kBAAmB,iMACnBC,mBAAoBf,EAAQgB,qBAAuBC,EAAEV,EAAOP,QAAyB,iBAAGkB,KAAK,WAC7FC,UAAW,kBACXC,QAAS,WACPb,EAAOC,MAAMU,KAAK,kBAAkBG,MAAM,WACxCd,EAAOe,WAETf,EAAOC,MAAMU,KAAK,qBAAqBK,QAAQ,SAAUC,GAChB,MAAlCA,EAAEC,UAAYD,EAAEE,SAAW,IAC9BnB,EAAOe,YAIbK,SAAU,WACRpB,EAAOJ,WAAWH,GAASE,KAAK,WAC9BT,KACC,WACDC,eAQLZ,EApFW","file":"cot_login_ext.min.js","sourcesContent":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* global cot_app cot_login CotSession */\n\n/* exported cot_login_ext */\nvar cot_login_ext = function (_cot_login) {\n  _inherits(cot_login_ext, _cot_login);\n\n  function cot_login_ext() {\n    _classCallCheck(this, cot_login_ext);\n\n    return _possibleConstructorReturn(this, (cot_login_ext.__proto__ || Object.getPrototypeOf(cot_login_ext)).apply(this, arguments));\n  }\n\n  _createClass(cot_login_ext, [{\n    key: 'checkLogin',\n    value: function checkLogin() {\n      var _this2 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (!options.serverSide) {\n        return this.session.isLoggedIn() ? Promise.resolve() : Promise.reject();\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this2.session.isLoggedIn(function (result) {\n          if (result === CotSession.LOGIN_CHECK_RESULT_TRUE) {\n            resolve();\n          } else {\n            reject();\n          }\n        });\n      });\n    }\n  }, {\n    key: 'requireLogin',\n    value: function requireLogin(options) {\n      var _this3 = this;\n\n      return Promise.resolve().then(function () {\n        return _this3.checkLogin(options);\n      }).catch(function () {\n        return _this3.showLogin(options);\n      }).catch(function () {\n        _this3.logout();\n        return Promise.reject();\n      });\n    }\n  }, {\n    key: 'showLogin',\n    value: function showLogin() {\n      var _this4 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (this.modal) {\n        this.modal.modal('hide');\n      }\n\n      return new Promise(function (resolve, reject) {\n        _this4.modal = cot_app.showModal({\n          title: 'User Login',\n          body: '\\n          ' + _this4.options.loginMessage + '\\n          <form>\\n            <div class=\"form-group\">\\n              <label for=\"cot_login_username\">Username</label>:\\n              <input class=\"form-control\" id=\"cot_login_username\">\\n            </div>\\n            <div class=\"form-group\">\\n              <label for=\"cot_login_password\">Password</label>:\\n              <input class=\"form-control\" type=\"password\" id=\"cot_login_password\">\\n            </div>\\n          </form>\\n        ',\n          footerButtonsHtml: '\\n          <button class=\"btn btn-success\" type=\"button\" data-dismiss=\"modal\">Cancel</button>\\n          <button class=\"btn btn-success btn-cot-login\" type=\"button\">Login</button>\\n        ',\n          originatingElement: options.$originatingElement || $(_this4.options['welcomeSelector']).find('a.login'),\n          className: 'cot-login-modal',\n          onShown: function onShown() {\n            _this4.modal.find('.btn-cot-login').click(function () {\n              _this4._login();\n            });\n            _this4.modal.find('.modal-body input').keydown(function (e) {\n              if ((e.charCode || e.keyCode || 0) === 13) {\n                _this4._login();\n              }\n            });\n          },\n          onHidden: function onHidden() {\n            _this4.checkLogin(options).then(function () {\n              resolve();\n            }, function () {\n              reject();\n            });\n          }\n        });\n      });\n    }\n  }]);\n\n  return cot_login_ext;\n}(cot_login);"]}